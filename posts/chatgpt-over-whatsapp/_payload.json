[{"data":1,"prerenderedAt":1539},["Reactive",2],{"post-/posts/chatgpt-over-whatsapp":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"link":10,"date":11,"timeToRead":12,"tags":13,"body":15,"_type":1534,"_id":1535,"_source":1536,"_file":1537,"_extension":1538},"/posts/chatgpt-over-whatsapp","posts",false,"","Using ChatGPT on an airplane through free Whatsapp - ChatGPT Over Whatsapp (COW)","ChatGPT is pretty useful and I didn't want to give up access when I flew. Most airlines give messaging access for free... so ChatGPT over Whatsapp was born.","chatgpt-over-whatsapp","2025-01-14T00:00:00.000Z","7",[14],"Programming",{"type":16,"children":17,"toc":1531},"root",[18,26,64,72,77,107,127,132,137,505,510,1369,1377,1390,1395,1400,1405,1428,1433,1458,1484,1486,1492,1493,1525],{"type":19,"tag":20,"props":21,"children":22},"element","p",{},[23],{"type":24,"value":25},"text","I had a handful of flights coming up and knew that it would be convenient to have ChatGPT in the air - something to talk to if I ended up having a random question, wanted to know more about a movie before watching it (the summary blurbs rarely cut it), or just wanted to learn something new.",{"type":19,"tag":27,"props":28,"children":30},"side-by-side",{"left-width":29},"50%",[31,52],{"type":19,"tag":32,"props":33,"children":34},"template",{"v-slot:left":7},[35],{"type":19,"tag":20,"props":36,"children":37},{},[38,40,50],{"type":24,"value":39},"Unfortunately for me, even though ChatGPT is purely text based like any other messaging app, airlines don't allow free access to OpenAI. Fortunately for me, ChatGPT is purely text based - so I built my own interface using the ",{"type":19,"tag":41,"props":42,"children":47},"a",{"href":43,"rel":44,"target":46},"https://www.southwest.com/inflight-entertainment-portal",[45],"nofollow","_blank",[48],{"type":24,"value":49},"free messaging",{"type":24,"value":51}," provided.",{"type":19,"tag":32,"props":53,"children":54},{"v-slot:right":7},[55],{"type":19,"tag":20,"props":56,"children":57},{},[58],{"type":19,"tag":59,"props":60,"children":63},"img",{"alt":61,"src":62},"Free Messaging on Southwest","/posts/chatgpt-over-whatsapp/free_messaging.png",[],{"type":19,"tag":20,"props":65,"children":66},{},[67],{"type":19,"tag":59,"props":68,"children":71},{"alt":69,"src":70},"Architecture diagram","/posts/chatgpt-over-whatsapp/architecture.png",[],{"type":19,"tag":20,"props":73,"children":74},{},[75],{"type":24,"value":76},"The architecture was simple:",{"type":19,"tag":78,"props":79,"children":80},"ol",{},[81,87,92,97,102],{"type":19,"tag":82,"props":83,"children":84},"li",{},[85],{"type":24,"value":86},"use a free Twilio account with some developer credits",{"type":19,"tag":82,"props":88,"children":89},{},[90],{"type":24,"value":91},"add a webhook to my server to process the messages and serve the response from ChatGPT",{"type":19,"tag":82,"props":93,"children":94},{},[95],{"type":24,"value":96},"use the openai chat completions API to get responses back for my messages",{"type":19,"tag":82,"props":98,"children":99},{},[100],{"type":24,"value":101},"???",{"type":19,"tag":82,"props":103,"children":104},{},[105],{"type":24,"value":106},"profit",{"type":19,"tag":20,"props":108,"children":109},{},[110,112,117,122],{"type":24,"value":111},"Usually at this point I end up hitting a bunch of roadblocks with the implementation but surprisingly this time, none of that happened. The Twilio sandbox account wasn't too hard to set up and even provided a really basic tutorial to make sure that everything was set up properly:\n",{"type":19,"tag":59,"props":113,"children":116},{"alt":114,"src":115},"Join the Twilio sandbox in a single message","/posts/chatgpt-over-whatsapp/setup1.png",[],{"type":19,"tag":59,"props":118,"children":121},{"alt":119,"src":120},"Send messages from Twilio to Whatsapp","/posts/chatgpt-over-whatsapp/setup2.png",[],{"type":19,"tag":59,"props":123,"children":126},{"alt":124,"src":125},"Get messages from Whatsapp to Twilio using webhook","/posts/chatgpt-over-whatsapp/setup3.png",[],{"type":19,"tag":20,"props":128,"children":129},{},[130],{"type":24,"value":131},"Now if I was trying to doing this legitimately to provide a service for others, I would probably have to do a lot more in order to register my identity and prove that I'm an actual business (I'm not). But a sandbox account was able to do everything I needed. The only downside was that every 72 hours, I'd need to reconnect my phone number with Twilio by sending the \"Connect to WhatsApp Sandbox\" message.",{"type":19,"tag":20,"props":133,"children":134},{},[135],{"type":24,"value":136},"Now that I knew it was possible to send and receive Whatsapp messages from a webhook server, it was time to build that server. I haven't worked with Flask or the openai API before, but ChatGPT was kind enough to guide me in the right direction. After a few prompts, I was able to build a simple endpoint which would fetch the message parameters (From and Body). Then using the opanai chat completions API I get a response and return that back to the Twilio caller.",{"type":19,"tag":138,"props":139,"children":143},"pre",{"className":140,"code":141,"language":142,"meta":7,"style":7},"language-python shiki shiki-themes github-dark github-light solarized-light","@app.route('/webhook', methods=['POST'])\ndef webhook():\n  sender_number = request.values.get('From', '').strip()\n  incoming_msg = request.values.get('Body', '').strip()\n  response = openai.chat.completions.create(\n    model=model,\n    messages=[\n      {\"role\": \"user\", \"content\": incoming_msg}\n    ]\n  )\n  bot_reply = response.choices[0].message.content.strip()\n\n  twilio_resp = MessagingResponse()\n  twilio_resp.message(body=bot_reply)\n  return str(twilio_resp)\n","python",[144],{"type":19,"tag":145,"props":146,"children":147},"code",{"__ignoreMap":7},[148,204,224,261,295,313,331,349,387,396,405,434,444,462,485],{"type":19,"tag":149,"props":150,"children":153},"span",{"class":151,"line":152},"line",1,[154,160,166,172,177,183,189,194,199],{"type":19,"tag":149,"props":155,"children":157},{"style":156},"--shiki-default:#B392F0;--shiki-light:#6F42C1;--shiki-sepia:#268BD2",[158],{"type":24,"value":159},"@app.route",{"type":19,"tag":149,"props":161,"children":163},{"style":162},"--shiki-default:#E1E4E8;--shiki-light:#24292E;--shiki-sepia:#657B83",[164],{"type":24,"value":165},"(",{"type":19,"tag":149,"props":167,"children":169},{"style":168},"--shiki-default:#9ECBFF;--shiki-light:#032F62;--shiki-sepia:#2AA198",[170],{"type":24,"value":171},"'/webhook'",{"type":19,"tag":149,"props":173,"children":174},{"style":162},[175],{"type":24,"value":176},", ",{"type":19,"tag":149,"props":178,"children":180},{"style":179},"--shiki-default:#FFAB70;--shiki-light:#E36209;--shiki-sepia:#657B83",[181],{"type":24,"value":182},"methods",{"type":19,"tag":149,"props":184,"children":186},{"style":185},"--shiki-default:#F97583;--shiki-light:#D73A49;--shiki-sepia:#859900",[187],{"type":24,"value":188},"=",{"type":19,"tag":149,"props":190,"children":191},{"style":162},[192],{"type":24,"value":193},"[",{"type":19,"tag":149,"props":195,"children":196},{"style":168},[197],{"type":24,"value":198},"'POST'",{"type":19,"tag":149,"props":200,"children":201},{"style":162},[202],{"type":24,"value":203},"])\n",{"type":19,"tag":149,"props":205,"children":207},{"class":151,"line":206},2,[208,214,219],{"type":19,"tag":149,"props":209,"children":211},{"style":210},"--shiki-default:#F97583;--shiki-light:#D73A49;--shiki-sepia:#586E75;--shiki-default-font-weight:inherit;--shiki-light-font-weight:inherit;--shiki-sepia-font-weight:bold",[212],{"type":24,"value":213},"def",{"type":19,"tag":149,"props":215,"children":216},{"style":156},[217],{"type":24,"value":218}," webhook",{"type":19,"tag":149,"props":220,"children":221},{"style":162},[222],{"type":24,"value":223},"():\n",{"type":19,"tag":149,"props":225,"children":227},{"class":151,"line":226},3,[228,233,237,242,247,251,256],{"type":19,"tag":149,"props":229,"children":230},{"style":162},[231],{"type":24,"value":232},"  sender_number ",{"type":19,"tag":149,"props":234,"children":235},{"style":185},[236],{"type":24,"value":188},{"type":19,"tag":149,"props":238,"children":239},{"style":162},[240],{"type":24,"value":241}," request.values.get(",{"type":19,"tag":149,"props":243,"children":244},{"style":168},[245],{"type":24,"value":246},"'From'",{"type":19,"tag":149,"props":248,"children":249},{"style":162},[250],{"type":24,"value":176},{"type":19,"tag":149,"props":252,"children":253},{"style":168},[254],{"type":24,"value":255},"''",{"type":19,"tag":149,"props":257,"children":258},{"style":162},[259],{"type":24,"value":260},").strip()\n",{"type":19,"tag":149,"props":262,"children":264},{"class":151,"line":263},4,[265,270,274,278,283,287,291],{"type":19,"tag":149,"props":266,"children":267},{"style":162},[268],{"type":24,"value":269},"  incoming_msg ",{"type":19,"tag":149,"props":271,"children":272},{"style":185},[273],{"type":24,"value":188},{"type":19,"tag":149,"props":275,"children":276},{"style":162},[277],{"type":24,"value":241},{"type":19,"tag":149,"props":279,"children":280},{"style":168},[281],{"type":24,"value":282},"'Body'",{"type":19,"tag":149,"props":284,"children":285},{"style":162},[286],{"type":24,"value":176},{"type":19,"tag":149,"props":288,"children":289},{"style":168},[290],{"type":24,"value":255},{"type":19,"tag":149,"props":292,"children":293},{"style":162},[294],{"type":24,"value":260},{"type":19,"tag":149,"props":296,"children":298},{"class":151,"line":297},5,[299,304,308],{"type":19,"tag":149,"props":300,"children":301},{"style":162},[302],{"type":24,"value":303},"  response ",{"type":19,"tag":149,"props":305,"children":306},{"style":185},[307],{"type":24,"value":188},{"type":19,"tag":149,"props":309,"children":310},{"style":162},[311],{"type":24,"value":312}," openai.chat.completions.create(\n",{"type":19,"tag":149,"props":314,"children":316},{"class":151,"line":315},6,[317,322,326],{"type":19,"tag":149,"props":318,"children":319},{"style":179},[320],{"type":24,"value":321},"    model",{"type":19,"tag":149,"props":323,"children":324},{"style":185},[325],{"type":24,"value":188},{"type":19,"tag":149,"props":327,"children":328},{"style":162},[329],{"type":24,"value":330},"model,\n",{"type":19,"tag":149,"props":332,"children":334},{"class":151,"line":333},7,[335,340,344],{"type":19,"tag":149,"props":336,"children":337},{"style":179},[338],{"type":24,"value":339},"    messages",{"type":19,"tag":149,"props":341,"children":342},{"style":185},[343],{"type":24,"value":188},{"type":19,"tag":149,"props":345,"children":346},{"style":162},[347],{"type":24,"value":348},"[\n",{"type":19,"tag":149,"props":350,"children":352},{"class":151,"line":351},8,[353,358,363,368,373,377,382],{"type":19,"tag":149,"props":354,"children":355},{"style":162},[356],{"type":24,"value":357},"      {",{"type":19,"tag":149,"props":359,"children":360},{"style":168},[361],{"type":24,"value":362},"\"role\"",{"type":19,"tag":149,"props":364,"children":365},{"style":162},[366],{"type":24,"value":367},": ",{"type":19,"tag":149,"props":369,"children":370},{"style":168},[371],{"type":24,"value":372},"\"user\"",{"type":19,"tag":149,"props":374,"children":375},{"style":162},[376],{"type":24,"value":176},{"type":19,"tag":149,"props":378,"children":379},{"style":168},[380],{"type":24,"value":381},"\"content\"",{"type":19,"tag":149,"props":383,"children":384},{"style":162},[385],{"type":24,"value":386},": incoming_msg}\n",{"type":19,"tag":149,"props":388,"children":390},{"class":151,"line":389},9,[391],{"type":19,"tag":149,"props":392,"children":393},{"style":162},[394],{"type":24,"value":395},"    ]\n",{"type":19,"tag":149,"props":397,"children":399},{"class":151,"line":398},10,[400],{"type":19,"tag":149,"props":401,"children":402},{"style":162},[403],{"type":24,"value":404},"  )\n",{"type":19,"tag":149,"props":406,"children":408},{"class":151,"line":407},11,[409,414,418,423,429],{"type":19,"tag":149,"props":410,"children":411},{"style":162},[412],{"type":24,"value":413},"  bot_reply ",{"type":19,"tag":149,"props":415,"children":416},{"style":185},[417],{"type":24,"value":188},{"type":19,"tag":149,"props":419,"children":420},{"style":162},[421],{"type":24,"value":422}," response.choices[",{"type":19,"tag":149,"props":424,"children":426},{"style":425},"--shiki-default:#79B8FF;--shiki-light:#005CC5;--shiki-sepia:#D33682",[427],{"type":24,"value":428},"0",{"type":19,"tag":149,"props":430,"children":431},{"style":162},[432],{"type":24,"value":433},"].message.content.strip()\n",{"type":19,"tag":149,"props":435,"children":437},{"class":151,"line":436},12,[438],{"type":19,"tag":149,"props":439,"children":441},{"emptyLinePlaceholder":440},true,[442],{"type":24,"value":443},"\n",{"type":19,"tag":149,"props":445,"children":447},{"class":151,"line":446},13,[448,453,457],{"type":19,"tag":149,"props":449,"children":450},{"style":162},[451],{"type":24,"value":452},"  twilio_resp ",{"type":19,"tag":149,"props":454,"children":455},{"style":185},[456],{"type":24,"value":188},{"type":19,"tag":149,"props":458,"children":459},{"style":162},[460],{"type":24,"value":461}," MessagingResponse()\n",{"type":19,"tag":149,"props":463,"children":465},{"class":151,"line":464},14,[466,471,476,480],{"type":19,"tag":149,"props":467,"children":468},{"style":162},[469],{"type":24,"value":470},"  twilio_resp.message(",{"type":19,"tag":149,"props":472,"children":473},{"style":179},[474],{"type":24,"value":475},"body",{"type":19,"tag":149,"props":477,"children":478},{"style":185},[479],{"type":24,"value":188},{"type":19,"tag":149,"props":481,"children":482},{"style":162},[483],{"type":24,"value":484},"bot_reply)\n",{"type":19,"tag":149,"props":486,"children":488},{"class":151,"line":487},15,[489,494,500],{"type":19,"tag":149,"props":490,"children":491},{"style":185},[492],{"type":24,"value":493},"  return",{"type":19,"tag":149,"props":495,"children":497},{"style":496},"--shiki-default:#79B8FF;--shiki-light:#005CC5;--shiki-sepia:#859900",[498],{"type":24,"value":499}," str",{"type":19,"tag":149,"props":501,"children":502},{"style":162},[503],{"type":24,"value":504},"(twilio_resp)\n",{"type":19,"tag":20,"props":506,"children":507},{},[508],{"type":24,"value":509},"Time to test.",{"type":19,"tag":27,"props":511,"children":512},{},[513,1358],{"type":19,"tag":32,"props":514,"children":515},{"v-slot:left":7},[516,544,885,898,1353],{"type":19,"tag":20,"props":517,"children":518},{},[519,521,527,529,542],{"type":24,"value":520},"In the sandbox settings, I was able to configure the webhook URL which would process the API. Super simple! Only problem was that I wasn't sure how to expose my local development environment to Twilio. ",{"type":19,"tag":41,"props":522,"children":525},{"href":523,"rel":524,"target":46},"http://localhost:5000",[45],[526],{"type":24,"value":523},{"type":24,"value":528}," wasn't going to cut it... Enter ngrok. The installation and setup for this was just as easy",{"type":19,"tag":530,"props":531,"children":532},"sup",{},[533],{"type":19,"tag":41,"props":534,"children":539},{"href":535,"ariaDescribedBy":536,"dataFootnoteRef":7,"id":538},"#user-content-fn-1",[537],"footnote-label","user-content-fnref-1",[540],{"type":24,"value":541},"1",{"type":24,"value":543},". I copied one command to install ngrok and one to configure my auth-token and in 3 minutes I was ready to start testing.",{"type":19,"tag":138,"props":545,"children":549},{"className":546,"code":547,"language":548,"meta":7,"style":7},"language-bash shiki shiki-themes github-dark github-light solarized-light","$ ngrok http http://localhost:5000\nSession Status                online                                                                          \nAccount                       Preetham (Plan: Free)\nVersion                       3.18.0                               \nRegion                        United States (California) (us-cal-1)    \nLatency                       24ms                             \nWeb Interface                 http://127.0.0.1:4040          \nForwarding                    https://xxxx-12-34-56-789.ngrok-free.app \n                              -> http://localhost:5000  \nHTTP Requests                                                                                            \n19:22:24.771 PDT POST /webhook                  200 OK               \n19:06:56.130 PDT POST /webhook                  200 OK              \n19:06:07.251 PDT POST /                         200 OK              \n","bash",[550],{"type":19,"tag":145,"props":551,"children":552},{"__ignoreMap":7},[553,576,599,627,650,683,706,729,747,765,783,821,854],{"type":19,"tag":149,"props":554,"children":555},{"class":151,"line":152},[556,561,566,571],{"type":19,"tag":149,"props":557,"children":558},{"style":156},[559],{"type":24,"value":560},"$",{"type":19,"tag":149,"props":562,"children":563},{"style":168},[564],{"type":24,"value":565}," ngrok",{"type":19,"tag":149,"props":567,"children":568},{"style":168},[569],{"type":24,"value":570}," http",{"type":19,"tag":149,"props":572,"children":573},{"style":168},[574],{"type":24,"value":575}," http://localhost:5000\n",{"type":19,"tag":149,"props":577,"children":578},{"class":151,"line":206},[579,584,589,594],{"type":19,"tag":149,"props":580,"children":581},{"style":156},[582],{"type":24,"value":583},"Session",{"type":19,"tag":149,"props":585,"children":586},{"style":168},[587],{"type":24,"value":588}," Status",{"type":19,"tag":149,"props":590,"children":591},{"style":168},[592],{"type":24,"value":593},"                online",{"type":19,"tag":149,"props":595,"children":596},{"style":162},[597],{"type":24,"value":598},"                                                                          \n",{"type":19,"tag":149,"props":600,"children":601},{"class":151,"line":226},[602,607,612,617,622],{"type":19,"tag":149,"props":603,"children":604},{"style":156},[605],{"type":24,"value":606},"Account",{"type":19,"tag":149,"props":608,"children":609},{"style":168},[610],{"type":24,"value":611},"                       Preetham",{"type":19,"tag":149,"props":613,"children":614},{"style":162},[615],{"type":24,"value":616}," (Plan: ",{"type":19,"tag":149,"props":618,"children":619},{"style":168},[620],{"type":24,"value":621},"Free",{"type":19,"tag":149,"props":623,"children":624},{"style":162},[625],{"type":24,"value":626},")\n",{"type":19,"tag":149,"props":628,"children":629},{"class":151,"line":263},[630,635,640,645],{"type":19,"tag":149,"props":631,"children":632},{"style":156},[633],{"type":24,"value":634},"Version",{"type":19,"tag":149,"props":636,"children":637},{"style":425},[638],{"type":24,"value":639},"                       3.18",{"type":19,"tag":149,"props":641,"children":642},{"style":168},[643],{"type":24,"value":644},".0",{"type":19,"tag":149,"props":646,"children":647},{"style":162},[648],{"type":24,"value":649},"                               \n",{"type":19,"tag":149,"props":651,"children":652},{"class":151,"line":297},[653,658,663,668,673,678],{"type":19,"tag":149,"props":654,"children":655},{"style":156},[656],{"type":24,"value":657},"Region",{"type":19,"tag":149,"props":659,"children":660},{"style":168},[661],{"type":24,"value":662},"                        United",{"type":19,"tag":149,"props":664,"children":665},{"style":168},[666],{"type":24,"value":667}," States",{"type":19,"tag":149,"props":669,"children":670},{"style":162},[671],{"type":24,"value":672}," (California) (",{"type":19,"tag":149,"props":674,"children":675},{"style":156},[676],{"type":24,"value":677},"us-cal-1",{"type":19,"tag":149,"props":679,"children":680},{"style":162},[681],{"type":24,"value":682},")    \n",{"type":19,"tag":149,"props":684,"children":685},{"class":151,"line":315},[686,691,696,701],{"type":19,"tag":149,"props":687,"children":688},{"style":156},[689],{"type":24,"value":690},"Latency",{"type":19,"tag":149,"props":692,"children":693},{"style":425},[694],{"type":24,"value":695},"                       24",{"type":19,"tag":149,"props":697,"children":698},{"style":168},[699],{"type":24,"value":700},"ms",{"type":19,"tag":149,"props":702,"children":703},{"style":162},[704],{"type":24,"value":705},"                             \n",{"type":19,"tag":149,"props":707,"children":708},{"class":151,"line":333},[709,714,719,724],{"type":19,"tag":149,"props":710,"children":711},{"style":156},[712],{"type":24,"value":713},"Web",{"type":19,"tag":149,"props":715,"children":716},{"style":168},[717],{"type":24,"value":718}," Interface",{"type":19,"tag":149,"props":720,"children":721},{"style":168},[722],{"type":24,"value":723},"                 http://127.0.0.1:4040",{"type":19,"tag":149,"props":725,"children":726},{"style":162},[727],{"type":24,"value":728},"          \n",{"type":19,"tag":149,"props":730,"children":731},{"class":151,"line":351},[732,737,742],{"type":19,"tag":149,"props":733,"children":734},{"style":156},[735],{"type":24,"value":736},"Forwarding",{"type":19,"tag":149,"props":738,"children":739},{"style":168},[740],{"type":24,"value":741},"                    https://xxxx-12-34-56-789.ngrok-free.app",{"type":19,"tag":149,"props":743,"children":744},{"style":162},[745],{"type":24,"value":746}," \n",{"type":19,"tag":149,"props":748,"children":749},{"class":151,"line":389},[750,755,760],{"type":19,"tag":149,"props":751,"children":752},{"style":156},[753],{"type":24,"value":754},"                              ->",{"type":19,"tag":149,"props":756,"children":757},{"style":168},[758],{"type":24,"value":759}," http://localhost:5000",{"type":19,"tag":149,"props":761,"children":762},{"style":162},[763],{"type":24,"value":764},"  \n",{"type":19,"tag":149,"props":766,"children":767},{"class":151,"line":398},[768,773,778],{"type":19,"tag":149,"props":769,"children":770},{"style":156},[771],{"type":24,"value":772},"HTTP",{"type":19,"tag":149,"props":774,"children":775},{"style":168},[776],{"type":24,"value":777}," Requests",{"type":19,"tag":149,"props":779,"children":780},{"style":162},[781],{"type":24,"value":782},"                                                                                            \n",{"type":19,"tag":149,"props":784,"children":785},{"class":151,"line":407},[786,791,796,801,806,811,816],{"type":19,"tag":149,"props":787,"children":788},{"style":156},[789],{"type":24,"value":790},"19:22:24.771",{"type":19,"tag":149,"props":792,"children":793},{"style":168},[794],{"type":24,"value":795}," PDT",{"type":19,"tag":149,"props":797,"children":798},{"style":168},[799],{"type":24,"value":800}," POST",{"type":19,"tag":149,"props":802,"children":803},{"style":168},[804],{"type":24,"value":805}," /webhook",{"type":19,"tag":149,"props":807,"children":808},{"style":425},[809],{"type":24,"value":810},"                  200",{"type":19,"tag":149,"props":812,"children":813},{"style":168},[814],{"type":24,"value":815}," OK",{"type":19,"tag":149,"props":817,"children":818},{"style":162},[819],{"type":24,"value":820},"               \n",{"type":19,"tag":149,"props":822,"children":823},{"class":151,"line":436},[824,829,833,837,841,845,849],{"type":19,"tag":149,"props":825,"children":826},{"style":156},[827],{"type":24,"value":828},"19:06:56.130",{"type":19,"tag":149,"props":830,"children":831},{"style":168},[832],{"type":24,"value":795},{"type":19,"tag":149,"props":834,"children":835},{"style":168},[836],{"type":24,"value":800},{"type":19,"tag":149,"props":838,"children":839},{"style":168},[840],{"type":24,"value":805},{"type":19,"tag":149,"props":842,"children":843},{"style":425},[844],{"type":24,"value":810},{"type":19,"tag":149,"props":846,"children":847},{"style":168},[848],{"type":24,"value":815},{"type":19,"tag":149,"props":850,"children":851},{"style":162},[852],{"type":24,"value":853},"              \n",{"type":19,"tag":149,"props":855,"children":856},{"class":151,"line":446},[857,862,866,870,875,880],{"type":19,"tag":149,"props":858,"children":859},{"style":156},[860],{"type":24,"value":861},"19:06:07.251",{"type":19,"tag":149,"props":863,"children":864},{"style":168},[865],{"type":24,"value":795},{"type":19,"tag":149,"props":867,"children":868},{"style":168},[869],{"type":24,"value":800},{"type":19,"tag":149,"props":871,"children":872},{"style":168},[873],{"type":24,"value":874}," /",{"type":19,"tag":149,"props":876,"children":877},{"style":425},[878],{"type":24,"value":879},"                         200",{"type":19,"tag":149,"props":881,"children":882},{"style":168},[883],{"type":24,"value":884}," OK\n",{"type":19,"tag":20,"props":886,"children":887},{},[888,890,896],{"type":24,"value":889},"I copied the Forwarding URL into my Twilio sandbox settings and tried it out... It didn't work. Checking the logs made the error pretty clear though. I forgot to add the ",{"type":19,"tag":145,"props":891,"children":893},{"className":892},[],[894],{"type":24,"value":895},"/webhook",{"type":24,"value":897}," suffix where my endpoint was located.",{"type":19,"tag":138,"props":899,"children":901},{"className":546,"code":900,"language":548,"meta":7,"style":7},"Creating chatgpt-whatsapp_web_1 ... done\nAttaching to chatgpt-whatsapp_web_1\nweb_1  |  * Serving Flask app 'app'\nweb_1  |  * Debug mode: off\nweb_1  | WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\nweb_1  |  * Running on all addresses (0.0.0.0)\nweb_1  |  * Running on http://127.0.0.1:5000\nweb_1  |  * Running on http://172.19.0.2:5000\nweb_1  | Press CTRL+C to quit\nweb_1  | 172.19.0.1 - - [20/Oct/2024 02:06:09] \"POST / HTTP/1.1\" 404 -\nweb_1  | 172.19.0.1 - - [20/Oct/2024 02:06:58] \"POST /webhook HTTP/1.1\" 200 -\n",[902],{"type":19,"tag":145,"props":903,"children":904},{"__ignoreMap":7},[905,928,946,984,1014,1122,1162,1190,1218,1248,1303],{"type":19,"tag":149,"props":906,"children":907},{"class":151,"line":152},[908,913,918,923],{"type":19,"tag":149,"props":909,"children":910},{"style":156},[911],{"type":24,"value":912},"Creating",{"type":19,"tag":149,"props":914,"children":915},{"style":168},[916],{"type":24,"value":917}," chatgpt-whatsapp_web_1",{"type":19,"tag":149,"props":919,"children":920},{"style":168},[921],{"type":24,"value":922}," ...",{"type":19,"tag":149,"props":924,"children":925},{"style":168},[926],{"type":24,"value":927}," done\n",{"type":19,"tag":149,"props":929,"children":930},{"class":151,"line":206},[931,936,941],{"type":19,"tag":149,"props":932,"children":933},{"style":156},[934],{"type":24,"value":935},"Attaching",{"type":19,"tag":149,"props":937,"children":938},{"style":168},[939],{"type":24,"value":940}," to",{"type":19,"tag":149,"props":942,"children":943},{"style":168},[944],{"type":24,"value":945}," chatgpt-whatsapp_web_1\n",{"type":19,"tag":149,"props":947,"children":948},{"class":151,"line":226},[949,954,959,964,969,974,979],{"type":19,"tag":149,"props":950,"children":951},{"style":156},[952],{"type":24,"value":953},"web_1",{"type":19,"tag":149,"props":955,"children":956},{"style":185},[957],{"type":24,"value":958},"  |",{"type":19,"tag":149,"props":960,"children":961},{"style":156},[962],{"type":24,"value":963},"  *",{"type":19,"tag":149,"props":965,"children":966},{"style":168},[967],{"type":24,"value":968}," Serving",{"type":19,"tag":149,"props":970,"children":971},{"style":168},[972],{"type":24,"value":973}," Flask",{"type":19,"tag":149,"props":975,"children":976},{"style":168},[977],{"type":24,"value":978}," app",{"type":19,"tag":149,"props":980,"children":981},{"style":168},[982],{"type":24,"value":983}," 'app'\n",{"type":19,"tag":149,"props":985,"children":986},{"class":151,"line":263},[987,991,995,999,1004,1009],{"type":19,"tag":149,"props":988,"children":989},{"style":156},[990],{"type":24,"value":953},{"type":19,"tag":149,"props":992,"children":993},{"style":185},[994],{"type":24,"value":958},{"type":19,"tag":149,"props":996,"children":997},{"style":156},[998],{"type":24,"value":963},{"type":19,"tag":149,"props":1000,"children":1001},{"style":168},[1002],{"type":24,"value":1003}," Debug",{"type":19,"tag":149,"props":1005,"children":1006},{"style":168},[1007],{"type":24,"value":1008}," mode:",{"type":19,"tag":149,"props":1010,"children":1011},{"style":168},[1012],{"type":24,"value":1013}," off\n",{"type":19,"tag":149,"props":1015,"children":1016},{"class":151,"line":297},[1017,1021,1025,1030,1035,1040,1045,1050,1055,1060,1065,1070,1075,1080,1084,1089,1094,1099,1103,1107,1112,1117],{"type":19,"tag":149,"props":1018,"children":1019},{"style":156},[1020],{"type":24,"value":953},{"type":19,"tag":149,"props":1022,"children":1023},{"style":185},[1024],{"type":24,"value":958},{"type":19,"tag":149,"props":1026,"children":1027},{"style":156},[1028],{"type":24,"value":1029}," WARNING:",{"type":19,"tag":149,"props":1031,"children":1032},{"style":168},[1033],{"type":24,"value":1034}," This",{"type":19,"tag":149,"props":1036,"children":1037},{"style":168},[1038],{"type":24,"value":1039}," is",{"type":19,"tag":149,"props":1041,"children":1042},{"style":168},[1043],{"type":24,"value":1044}," a",{"type":19,"tag":149,"props":1046,"children":1047},{"style":168},[1048],{"type":24,"value":1049}," development",{"type":19,"tag":149,"props":1051,"children":1052},{"style":168},[1053],{"type":24,"value":1054}," server.",{"type":19,"tag":149,"props":1056,"children":1057},{"style":168},[1058],{"type":24,"value":1059}," Do",{"type":19,"tag":149,"props":1061,"children":1062},{"style":168},[1063],{"type":24,"value":1064}," not",{"type":19,"tag":149,"props":1066,"children":1067},{"style":168},[1068],{"type":24,"value":1069}," use",{"type":19,"tag":149,"props":1071,"children":1072},{"style":168},[1073],{"type":24,"value":1074}," it",{"type":19,"tag":149,"props":1076,"children":1077},{"style":168},[1078],{"type":24,"value":1079}," in",{"type":19,"tag":149,"props":1081,"children":1082},{"style":168},[1083],{"type":24,"value":1044},{"type":19,"tag":149,"props":1085,"children":1086},{"style":168},[1087],{"type":24,"value":1088}," production",{"type":19,"tag":149,"props":1090,"children":1091},{"style":168},[1092],{"type":24,"value":1093}," deployment.",{"type":19,"tag":149,"props":1095,"children":1096},{"style":168},[1097],{"type":24,"value":1098}," Use",{"type":19,"tag":149,"props":1100,"children":1101},{"style":168},[1102],{"type":24,"value":1044},{"type":19,"tag":149,"props":1104,"children":1105},{"style":168},[1106],{"type":24,"value":1088},{"type":19,"tag":149,"props":1108,"children":1109},{"style":168},[1110],{"type":24,"value":1111}," WSGI",{"type":19,"tag":149,"props":1113,"children":1114},{"style":168},[1115],{"type":24,"value":1116}," server",{"type":19,"tag":149,"props":1118,"children":1119},{"style":168},[1120],{"type":24,"value":1121}," instead.\n",{"type":19,"tag":149,"props":1123,"children":1124},{"class":151,"line":315},[1125,1129,1133,1137,1142,1147,1152,1157],{"type":19,"tag":149,"props":1126,"children":1127},{"style":156},[1128],{"type":24,"value":953},{"type":19,"tag":149,"props":1130,"children":1131},{"style":185},[1132],{"type":24,"value":958},{"type":19,"tag":149,"props":1134,"children":1135},{"style":156},[1136],{"type":24,"value":963},{"type":19,"tag":149,"props":1138,"children":1139},{"style":168},[1140],{"type":24,"value":1141}," Running",{"type":19,"tag":149,"props":1143,"children":1144},{"style":168},[1145],{"type":24,"value":1146}," on",{"type":19,"tag":149,"props":1148,"children":1149},{"style":168},[1150],{"type":24,"value":1151}," all",{"type":19,"tag":149,"props":1153,"children":1154},{"style":168},[1155],{"type":24,"value":1156}," addresses",{"type":19,"tag":149,"props":1158,"children":1159},{"style":162},[1160],{"type":24,"value":1161}," (0.0.0.0)\n",{"type":19,"tag":149,"props":1163,"children":1164},{"class":151,"line":333},[1165,1169,1173,1177,1181,1185],{"type":19,"tag":149,"props":1166,"children":1167},{"style":156},[1168],{"type":24,"value":953},{"type":19,"tag":149,"props":1170,"children":1171},{"style":185},[1172],{"type":24,"value":958},{"type":19,"tag":149,"props":1174,"children":1175},{"style":156},[1176],{"type":24,"value":963},{"type":19,"tag":149,"props":1178,"children":1179},{"style":168},[1180],{"type":24,"value":1141},{"type":19,"tag":149,"props":1182,"children":1183},{"style":168},[1184],{"type":24,"value":1146},{"type":19,"tag":149,"props":1186,"children":1187},{"style":168},[1188],{"type":24,"value":1189}," http://127.0.0.1:5000\n",{"type":19,"tag":149,"props":1191,"children":1192},{"class":151,"line":351},[1193,1197,1201,1205,1209,1213],{"type":19,"tag":149,"props":1194,"children":1195},{"style":156},[1196],{"type":24,"value":953},{"type":19,"tag":149,"props":1198,"children":1199},{"style":185},[1200],{"type":24,"value":958},{"type":19,"tag":149,"props":1202,"children":1203},{"style":156},[1204],{"type":24,"value":963},{"type":19,"tag":149,"props":1206,"children":1207},{"style":168},[1208],{"type":24,"value":1141},{"type":19,"tag":149,"props":1210,"children":1211},{"style":168},[1212],{"type":24,"value":1146},{"type":19,"tag":149,"props":1214,"children":1215},{"style":168},[1216],{"type":24,"value":1217}," http://172.19.0.2:5000\n",{"type":19,"tag":149,"props":1219,"children":1220},{"class":151,"line":389},[1221,1225,1229,1234,1239,1243],{"type":19,"tag":149,"props":1222,"children":1223},{"style":156},[1224],{"type":24,"value":953},{"type":19,"tag":149,"props":1226,"children":1227},{"style":185},[1228],{"type":24,"value":958},{"type":19,"tag":149,"props":1230,"children":1231},{"style":156},[1232],{"type":24,"value":1233}," Press",{"type":19,"tag":149,"props":1235,"children":1236},{"style":168},[1237],{"type":24,"value":1238}," CTRL+C",{"type":19,"tag":149,"props":1240,"children":1241},{"style":168},[1242],{"type":24,"value":940},{"type":19,"tag":149,"props":1244,"children":1245},{"style":168},[1246],{"type":24,"value":1247}," quit\n",{"type":19,"tag":149,"props":1249,"children":1250},{"class":151,"line":398},[1251,1255,1259,1264,1269,1273,1278,1283,1288,1293,1298],{"type":19,"tag":149,"props":1252,"children":1253},{"style":156},[1254],{"type":24,"value":953},{"type":19,"tag":149,"props":1256,"children":1257},{"style":185},[1258],{"type":24,"value":958},{"type":19,"tag":149,"props":1260,"children":1261},{"style":156},[1262],{"type":24,"value":1263}," 172.19.0.1",{"type":19,"tag":149,"props":1265,"children":1266},{"style":168},[1267],{"type":24,"value":1268}," -",{"type":19,"tag":149,"props":1270,"children":1271},{"style":168},[1272],{"type":24,"value":1268},{"type":19,"tag":149,"props":1274,"children":1275},{"style":162},[1276],{"type":24,"value":1277}," [20/Oct/2024 ",{"type":19,"tag":149,"props":1279,"children":1280},{"style":425},[1281],{"type":24,"value":1282},"02",{"type":19,"tag":149,"props":1284,"children":1285},{"style":168},[1286],{"type":24,"value":1287},":06:09]",{"type":19,"tag":149,"props":1289,"children":1290},{"style":168},[1291],{"type":24,"value":1292}," \"POST / HTTP/1.1\"",{"type":19,"tag":149,"props":1294,"children":1295},{"style":425},[1296],{"type":24,"value":1297}," 404",{"type":19,"tag":149,"props":1299,"children":1300},{"style":168},[1301],{"type":24,"value":1302}," -\n",{"type":19,"tag":149,"props":1304,"children":1305},{"class":151,"line":407},[1306,1310,1314,1318,1322,1326,1330,1334,1339,1344,1349],{"type":19,"tag":149,"props":1307,"children":1308},{"style":156},[1309],{"type":24,"value":953},{"type":19,"tag":149,"props":1311,"children":1312},{"style":185},[1313],{"type":24,"value":958},{"type":19,"tag":149,"props":1315,"children":1316},{"style":156},[1317],{"type":24,"value":1263},{"type":19,"tag":149,"props":1319,"children":1320},{"style":168},[1321],{"type":24,"value":1268},{"type":19,"tag":149,"props":1323,"children":1324},{"style":168},[1325],{"type":24,"value":1268},{"type":19,"tag":149,"props":1327,"children":1328},{"style":162},[1329],{"type":24,"value":1277},{"type":19,"tag":149,"props":1331,"children":1332},{"style":425},[1333],{"type":24,"value":1282},{"type":19,"tag":149,"props":1335,"children":1336},{"style":168},[1337],{"type":24,"value":1338},":06:58]",{"type":19,"tag":149,"props":1340,"children":1341},{"style":168},[1342],{"type":24,"value":1343}," \"POST /webhook HTTP/1.1\"",{"type":19,"tag":149,"props":1345,"children":1346},{"style":425},[1347],{"type":24,"value":1348}," 200",{"type":19,"tag":149,"props":1350,"children":1351},{"style":168},[1352],{"type":24,"value":1302},{"type":19,"tag":20,"props":1354,"children":1355},{},[1356],{"type":24,"value":1357},"Once I added that, everything worked perfectly. So perfectly that I wasn't even sure if I wanted to write a blog post about something that ended up being so simple.",{"type":19,"tag":32,"props":1359,"children":1360},{"v-slot:right":7},[1361],{"type":19,"tag":20,"props":1362,"children":1363},{},[1364],{"type":19,"tag":59,"props":1365,"children":1368},{"alt":1366,"src":1367},"Initial setup and response from OpenAI API (with a few quickly fixed errors along the way)","/posts/chatgpt-over-whatsapp/initial_setup.jpg",[],{"type":19,"tag":20,"props":1370,"children":1371},{},[1372],{"type":19,"tag":59,"props":1373,"children":1376},{"alt":1374,"src":1375},"Sandbox settings","/posts/chatgpt-over-whatsapp/sandbox_settings.png",[],{"type":19,"tag":20,"props":1378,"children":1379},{},[1380,1382,1388],{"type":24,"value":1381},"Deploying this to production was as simple as starting up the docker container on my production DigitalOcean instance and changing the webhook URL in the Twilio sandbox settings. Note that even if you set an IP address as the URL, you still need to add the ",{"type":19,"tag":145,"props":1383,"children":1385},{"className":1384},[],[1386],{"type":24,"value":1387},"http://",{"type":24,"value":1389}," prefix.",{"type":19,"tag":20,"props":1391,"children":1392},{},[1393],{"type":24,"value":1394},"Afterwards in order to make things a bit more complex, I wanted to support a feature to allow users to change the server model - by default it was using 4o-mini, but maybe if I was more price conscious I could switch to 3.5-turbo or if I wanted more intelligence I could try 4o or gpt-4.",{"type":19,"tag":20,"props":1396,"children":1397},{},[1398],{"type":24,"value":1399},"Finally I tried adding a way to check how many credits I have left on my accounts. Unfortunately OpenAI doesn't provide an API for this and I wasn't prepared to reverse engineer the OpenAI dashboard page. It turns out that ChatGPT is a lot cheaper than I expected - the $5 in credits would probably last me longer than my Twilio credits so I wasn't too worried about getting this to work.",{"type":19,"tag":20,"props":1401,"children":1402},{},[1403],{"type":24,"value":1404},"So in conclusion, all I needed in order to get this working was:",{"type":19,"tag":78,"props":1406,"children":1407},{},[1408,1413,1418,1423],{"type":19,"tag":82,"props":1409,"children":1410},{},[1411],{"type":24,"value":1412},"some Twilio credits",{"type":19,"tag":82,"props":1414,"children":1415},{},[1416],{"type":24,"value":1417},"OpenAI credits",{"type":19,"tag":82,"props":1419,"children":1420},{},[1421],{"type":24,"value":1422},"a DigitalOcean server",{"type":19,"tag":82,"props":1424,"children":1425},{},[1426],{"type":24,"value":1427},"a few hours building and deploying this webapp",{"type":19,"tag":20,"props":1429,"children":1430},{},[1431],{"type":24,"value":1432},"Is it probably cheaper and easier to just pay for in flight Wifi? Yes. But that's no fun.",{"type":19,"tag":27,"props":1434,"children":1435},{"left-width":29},[1436,1447],{"type":19,"tag":32,"props":1437,"children":1438},{"v-slot:left":7},[1439],{"type":19,"tag":20,"props":1440,"children":1441},{},[1442],{"type":19,"tag":59,"props":1443,"children":1446},{"alt":1444,"src":1445},"First picture on a plane in airplane mode","/posts/chatgpt-over-whatsapp/airplane1.jpg",[],{"type":19,"tag":32,"props":1448,"children":1449},{"v-slot:right":7},[1450],{"type":19,"tag":20,"props":1451,"children":1452},{},[1453],{"type":19,"tag":59,"props":1454,"children":1457},{"alt":1455,"src":1456},"Second picture showing reply from ChatGPT in airplane mode","/posts/chatgpt-over-whatsapp/airplane2.jpg",[],{"type":19,"tag":1459,"props":1460,"children":1463},"blockquote",{"className":1461},[1462],"twitter-tweet",[1464,1476,1478],{"type":19,"tag":20,"props":1465,"children":1468},{"lang":1466,"dir":1467},"en","ltr",[1469,1471],{"type":24,"value":1470},"Got ChatGPT working on an airline by routing it through Whatsapp.",{"type":19,"tag":41,"props":1472,"children":1474},{"href":1473},"https://t.co/EXeJ8RfstK",[1475],{"type":24,"value":1473},{"type":24,"value":1477},"— preethamrn (@preethamrn) ",{"type":19,"tag":41,"props":1479,"children":1481},{"href":1480},"https://twitter.com/preethamrn/status/1879771989692613085?ref_src=twsrc%5Etfw",[1482],{"type":24,"value":1483},"January 16, 2025",{"type":24,"value":1485}," ",{"type":19,"tag":1487,"props":1488,"children":1491},"script",{"async":440,"src":1489,"charSet":1490},"https://platform.twitter.com/widgets.js","utf-8",[],{"type":24,"value":746},{"type":19,"tag":1494,"props":1495,"children":1498},"section",{"className":1496,"dataFootnotes":7},[1497],"footnotes",[1499,1507],{"type":19,"tag":1500,"props":1501,"children":1504},"h2",{"className":1502,"id":537},[1503],"sr-only",[1505],{"type":24,"value":1506},"Footnotes",{"type":19,"tag":78,"props":1508,"children":1509},{},[1510],{"type":19,"tag":82,"props":1511,"children":1513},{"id":1512},"user-content-fn-1",[1514,1516],{"type":24,"value":1515},"It's a little scary how easy it was to expose my local network to the outside world. ",{"type":19,"tag":41,"props":1517,"children":1522},{"href":1518,"ariaLabel":1519,"className":1520,"dataFootnoteBackref":7},"#user-content-fnref-1","Back to reference 1",[1521],"data-footnote-backref",[1523],{"type":24,"value":1524},"↩",{"type":19,"tag":1526,"props":1527,"children":1528},"style",{},[1529],{"type":24,"value":1530},"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":7,"searchDepth":206,"depth":206,"links":1532},[1533],{"id":537,"depth":206,"text":1506},"markdown","content:posts:chatgpt-over-whatsapp.md","content","posts/chatgpt-over-whatsapp.md","md",1737325882193]